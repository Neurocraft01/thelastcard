{% extends 'base.html' %}
{% load static %}

{% block title %}My Orders - TLC{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 py-10 px-4 sm:px-6 lg:px-8">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <div class="flex items-center justify-between mb-8">
            <div class="flex items-center gap-3">
                <a href="{% url 'accounts:dashboard_redirect' %}" class="inline-flex items-center justify-center size-10 rounded-xl bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 transition-colors">
                    <span class="material-symbols-rounded text-xl">arrow_back</span>
                </a>
                <div>
                    <h1 class="text-3xl font-bold text-slate-900 tracking-tight">My Orders</h1>
                    <p class="text-slate-500 mt-1">Track and manage your PVC card orders</p>
                </div>
            </div>
            <a href="{% url 'orders:create' %}" class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-[#0f172a] to-[#1e293b] text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-0.5">
                <span class="material-symbols-rounded">add</span>
                <span>New Order</span>
            </a>
        </div>

        {% if orders %}
            <!-- Orders List -->
            <div class="space-y-4">
                {% for order in orders %}
                <div class="bg-white rounded-2xl border border-slate-200 p-6 shadow-sm hover:shadow-md transition-all">
                    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
                        <!-- Order Info -->
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-3">
                                <h3 class="text-lg font-bold text-slate-900">Order #{{ order.order_number }}</h3>
                                
                                <!-- Status Badge -->
                                {% if order.status == 'pending' %}
                                    <span class="inline-flex items-center gap-1 px-3 py-1 bg-yellow-100 text-yellow-800 text-xs font-semibold rounded-full">
                                        <span class="material-symbols-rounded text-sm">schedule</span>
                                        Pending
                                    </span>
                                {% elif order.status == 'processing' %}
                                    <span class="inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 text-xs font-semibold rounded-full">
                                        <span class="material-symbols-rounded text-sm">manufacturing</span>
                                        Processing
                                    </span>
                                {% elif order.status == 'shipped' %}
                                    <span class="inline-flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-800 text-xs font-semibold rounded-full">
                                        <span class="material-symbols-rounded text-sm">local_shipping</span>
                                        Shipped
                                    </span>
                                {% elif order.status == 'delivered' %}
                                    <span class="inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full">
                                        <span class="material-symbols-rounded text-sm">check_circle</span>
                                        Delivered
                                    </span>
                                {% elif order.status == 'cancelled' %}
                                    <span class="inline-flex items-center gap-1 px-3 py-1 bg-red-100 text-red-800 text-xs font-semibold rounded-full">
                                        <span class="material-symbols-rounded text-sm">cancel</span>
                                        Cancelled
                                    </span>
                                {% endif %}
                            </div>

                            <!-- Order Details -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-sm">
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">Card Type</p>
                                    <p class="font-semibold text-slate-900">{{ order.get_card_type_display }}</p>
                                </div>
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">Quantity</p>
                                    <p class="font-semibold text-slate-900">{{ order.quantity }} card{{ order.quantity|pluralize }}</p>
                                </div>
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">Total Price</p>
                                    <p class="font-semibold text-slate-900">â‚¹{{ order.total_price|floatformat:0 }}</p>
                                </div>
                                <div>
                                    <p class="text-slate-500 text-xs mb-1">Order Date</p>
                                    <p class="font-semibold text-slate-900">{{ order.created_at|date:"M d, Y" }}</p>
                                </div>
                            </div>

                            <!-- Tracking Number -->
                            {% if order.tracking_number %}
                            <div class="mt-3 pt-3 border-t border-slate-100">
                                <p class="text-xs text-slate-500 mb-1">Tracking Number</p>
                                <p class="font-mono text-sm font-semibold text-[#0284c7]">{{ order.tracking_number }}</p>
                            </div>
                            {% endif %}
                        </div>

                        <!-- Actions -->
                        <div class="flex lg:flex-col gap-2">
                            <a href="{% url 'orders:detail' order.id %}" class="flex-1 lg:flex-none inline-flex items-center justify-center gap-2 px-4 py-2 bg-slate-100 text-slate-700 rounded-lg font-medium hover:bg-slate-200 transition-colors text-sm">
                                <span class="material-symbols-rounded text-base">visibility</span>
                                <span>View Details</span>
                            </a>
                            
                            {% if order.status == 'delivered' %}
                            <button class="flex-1 lg:flex-none inline-flex items-center justify-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg font-medium hover:bg-green-200 transition-colors text-sm">
                                <span class="material-symbols-rounded text-base">download</span>
                                <span>Invoice</span>
                            </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Pagination (if needed) -->
            {% if is_paginated %}
            <div class="mt-8 flex justify-center gap-2">
                {% if page_obj.has_previous %}
                    <a href="?page={{ page_obj.previous_page_number }}" class="inline-flex items-center justify-center size-10 rounded-lg bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 transition-colors">
                        <span class="material-symbols-rounded">chevron_left</span>
                    </a>
                {% endif %}
                
                <div class="flex items-center gap-2">
                    {% for num in page_obj.paginator.page_range %}
                        {% if page_obj.number == num %}
                            <span class="inline-flex items-center justify-center size-10 rounded-lg bg-gradient-to-r from-[#0f172a] to-[#1e293b] text-white font-semibold">{{ num }}</span>
                        {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                            <a href="?page={{ num }}" class="inline-flex items-center justify-center size-10 rounded-lg bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 transition-colors">{{ num }}</a>
                        {% endif %}
                    {% endfor %}
                </div>

                {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}" class="inline-flex items-center justify-center size-10 rounded-lg bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 transition-colors">
                        <span class="material-symbols-rounded">chevron_right</span>
                    </a>
                {% endif %}
            </div>
            {% endif %}

        {% else %}
            <!-- Empty State -->
            <div class="bg-white rounded-2xl border border-slate-200 p-12 text-center shadow-sm">
                <div class="max-w-md mx-auto">
                    <div class="size-20 mx-auto mb-6 rounded-full bg-slate-100 flex items-center justify-center">
                        <span class="material-symbols-rounded text-5xl text-slate-400">shopping_bag</span>
                    </div>
                    <h2 class="text-2xl font-bold text-slate-900 mb-3">No Orders Yet</h2>
                    <p class="text-slate-500 mb-6">You haven't placed any orders for PVC cards. Start by creating your first order!</p>
                    <a href="{% url 'orders:create' %}" class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-[#0f172a] to-[#1e293b] text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-0.5">
                        <span class="material-symbols-rounded">add_circle</span>
                        <span>Place Your First Order</span>
                    </a>
                </div>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
